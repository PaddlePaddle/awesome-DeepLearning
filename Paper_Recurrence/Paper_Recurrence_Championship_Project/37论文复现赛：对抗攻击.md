# è®ºæ–‡å¤ç°ï¼šTowards Deep Learning Models Resistant to Adversarial Attacks

## ä¸€ã€ç®€ä»‹
å¯¹æŠ—æ”»å‡»ï¼šæ”»å‡»è€…å°±ä¼šé€šè¿‡è®¾è®¡ä¸€ç§æœ‰é’ˆå¯¹æ€§çš„æ•°å€¼å‹å‘é‡ä»è€Œè®©æœºå™¨å­¦ä¹ æ¨¡å‹åšå‡ºè¯¯åˆ¤ï¼Œè¿™ä¾¿è¢«ç§°ä¸ºå¯¹æŠ—æ€§æ”»å‡»ï¼Œç®€å•æ¥è¯´å°±æ˜¯ç ”ç©¶å¦‚ä½•ç”Ÿæˆèƒ½ä½¿ç½‘ç»œå‡ºé”™çš„æ ·æœ¬ã€‚

æ ¹æ®æ¡ä»¶ä¸åŒï¼Œå¯¹æŠ—æ”»å‡»ä¸»è¦å¯åˆ†ä¸ºï¼š
- é»‘ç›’æ”»å‡»ä¸ç™½ç›’æ”»å‡»ï¼ˆæ”»å‡»ç¯å¢ƒï¼‰
é»‘ç®±æ”»å‡»å‘ç›®æ ‡æ¨¡å‹æä¾›äº†ä¸äº†è§£è¯¥æ¨¡å‹è€Œç”Ÿæˆçš„å¯¹æŠ—æ ·æœ¬(åœ¨æµ‹è¯•æœŸé—´)ï¼›ç™½ç®±æ”»å‡»å‡å®šï¼ˆå¯¹æŠ—è€…ï¼‰å®Œå…¨äº†è§£ç›®æ ‡æ¨¡å‹ï¼ŒåŒ…æ‹¬å…¶å‚æ•°å€¼ã€ä½“ç³»ç»“æ„ã€è®­ç»ƒæ–¹æ³•ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹è¿˜åŒ…æ‹¬å…¶è®­ç»ƒæ•°æ®ã€‚
- æœ‰ç›®æ ‡æ”»å‡»å’Œæ— ç›®æ ‡æ”»å‡»ï¼ˆæ”»å‡»çš„ç›®æ ‡ï¼‰
æ— ç›®æ ‡æ”»å‡»æŒ‡æ”»å‡»åªè¦ä½¿å¾—ç½‘ç»œå‡ºé”™å³å¯ï¼Œç›®æ ‡æ”»å‡»åˆ™ä¸ä»…è¦ä½¿å¾—ç½‘ç»œå‡ºé”™ï¼Œè€Œä¸”è¦æŒ‡å®šé”™è¯¯çš„æƒ…å†µ
- åŸºäºæ¢¯åº¦çš„æ”»å‡»ã€åŸºäºä¼˜åŒ–çš„æ”»å‡»ã€åŸºäºå†³ç­–é¢çš„æ”»å‡»æˆ–è€…å…¶ä»–ï¼ˆæ”»å‡»å®ç°æ–¹å¼ï¼‰

æœ¬æ–‡ä»ä¼˜åŒ–è§’åº¦ç ”ç©¶äº†ç¥ç»ç½‘ç»œçš„å¯¹æŠ—é²æ£’æ€§é—®é¢˜ï¼Œå¹¶åœ¨æŸç§ç¨‹åº¦ä¸Šæå‡ºäº†ä¸€ç§å¯ä»¥æŠµå¾¡ä»»æ„æ”»å‡»çš„æ€è·¯ã€‚

å¯¹æŠ—æ”»å‡»æºäºç¥ç»ç½‘ç»œå¯¹è¾“å…¥ä¿¡æ¯çš„æ•æ„Ÿæ€§ï¼Œå½“è¾“å…¥ä¿¡æ¯åç¦»æ¨¡å‹è®­ç»ƒæ ·æœ¬çš„åˆ†å¸ƒç‰¹å¾æ—¶ï¼Œç½‘ç»œå¾ˆå¯èƒ½ç»™å‡ºé”™è¯¯çš„é¢„æµ‹å€¼ã€‚å¦‚æœåˆ©ç”¨æ­¤æ¼æ´ï¼Œå¯¹è¾“å…¥ä¿¡æ¯åšç²¾ç»†çš„æ”¹åŠ¨ï¼Œåˆ™å¯èƒ½å¯¼è‡´ç½‘ç»œä»¥é«˜ç½®ä¿¡åº¦ç»™å‡ºå®Œå…¨é”™è¯¯çš„é¢„æµ‹ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œäººçœ¼å®Œå…¨æ— æ³•åˆ†è¾¨çš„å·®å¼‚ï¼Œä¼šå¯¼è‡´ç½‘ç»œè¾“å‡ºé”™è¯¯ç»“æœã€‚

 ![](https://ai-studio-static-online.cdn.bcebos.com/5dd1e9d487af4db792fad963f40c8d6de75eb5a4feba48378c5b84d484bf3e6a)

 æœ¬æ–‡æå‡ºçš„æ–¹æ³•æ˜¯ï¼Œé¦–å…ˆåŸºäºåŸå§‹æ ·æœ¬ç”Ÿæˆå¯¹æŠ—æ ·æœ¬ï¼Œç„¶åå†åŸºäºå¯¹æŠ—æ ·æœ¬æ±‚è§£é£é™©æœŸæœ›ï¼š

 ![](https://ai-studio-static-online.cdn.bcebos.com/25ff8741ac8a45ca9f2e27d2f4486d3798b691749e334492b1a963ab8c70d64c)

 è¿™ç§Min-Maxé—®é¢˜ï¼Œä½œè€…åˆç§°ä¹‹ä¸ºéç‚¹é—®é¢˜ã€‚Maxæ±‚è§£çš„æ˜¯ï¼Œåœ¨å›ºå®šç½‘ç»œå‚æ•°çš„æƒ…å†µä¸‹ï¼Œæ‰¾å‡ºåŸå§‹æ ·æœ¬çš„ä¸€ä¸ªåç§»é‡ï¼Œä½¿å¾—Losså‡½æ•°åœ¨å±€éƒ¨å–å¾—æœ€å¤§å€¼ï¼Œå³ä¸ºæ±‚å‡ºæ­¤æ—¶çš„å¯¹æŠ—æ ·æœ¬ï¼›Minæ±‚è§£çš„æ˜¯ï¼Œåœ¨å¾—åˆ°å¯¹æŠ—æ ·æœ¬çš„æƒ…å†µä¸‹ï¼Œæ ¹æ®æ¢¯åº¦ä¸‹é™ï¼Œä½¿å¯¹æŠ—æ ·æœ¬çš„æœŸæœ›é£é™©æœ€å°åŒ–ã€‚

å¯¹æ¨¡å‹å‚æ•°å¯»ä¼˜ï¼Œå°±æ˜¯ç”¨å¸¸è§„çš„æ¢¯åº¦ä¸‹é™æ³•ï¼›å…³é”®æ˜¯å¦‚ä½•åœ¨å±€éƒ¨æ‰¾åˆ°åŸå§‹æ ·æœ¬çš„å¯¹æŠ—æ ·æœ¬ï¼Œè¿™ä¸ªæå¤§å€¼é—®é¢˜ã€‚

å¯»æ‰¾æœ€ä¼˜çš„å¯¹æŠ—æ ·æœ¬ï¼Œå¸¸ç”¨çš„æœ‰ä¸¤ç§æ–¹æ³•ï¼šFast Gradient Sign Methodï¼ˆFGSMï¼‰å’ŒProjected Gradient Decentï¼ˆPGDï¼‰æ–¹æ³•ã€‚

æ–‡ä¸­æœ‰ä¸€ä¸ªæœ‰è¶£çš„ç»“è®ºæ˜¯ï¼Œæ¨¡å‹è¶Šå¤§ï¼Œé€šè¿‡æœ¬æ–¹æ³•è·å¾—çš„æ•ˆæœè¶Šå¥½ã€‚æˆ‘åŸæœ¬è®¤ä¸ºçš„æ˜¯ï¼Œæ¨¡å‹å¯¹æŠ—æ”»å‡»é²æ£’æ€§å·®ï¼Œå¯èƒ½æ˜¯å› ä¸ºæ¨¡å‹å¤æ‚å¯¼è‡´äº†è¿‡æ‹Ÿåˆï¼›ä½†æ–‡ç« ç»™å‡ºçš„ç»“è®ºæ­£å¥½ç›¸åï¼Œä½œè€…ç»™å‡ºçš„åŸå› å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚

![](https://ai-studio-static-online.cdn.bcebos.com/b8b07e113b514eb28c3cf1c7173c82a254364978d28d4ddc8080b6baf11da2fa)

å¯ä»¥è¿™æ ·ç†è§£ï¼Œæ–‡ä¸­çš„æ–¹æ³•åœ¨å®¢è§‚ä¸Šç­‰æ•ˆäºéšæœºå¼•å…¥äº†å¤§é‡æ ·æœ¬å‚ä¸è®­ç»ƒï¼Œepsiloné‚»åŸŸè¶Šå¤§ï¼Œå‚ä¸è®­ç»ƒçš„æ ·æœ¬é‡è¶Šå¤§ï¼Œæ¨¡å‹è§„æ¨¡ä¹Ÿåº”è¯¥åŒæ­¥å¢åŠ ã€‚

è®ºæ–‡é“¾æ¥ï¼š[Towards Deep Learning Models Resistant to Adversarial Attacks](https://arxiv.org/pdf/1706.06083.pdf)


## äºŒã€å¤ç°ç²¾åº¦

åŸºäºpaddlepaddleæ·±åº¦å­¦ä¹ æ¡†æ¶ï¼Œå¯¹æ–‡çŒ®ç®—æ³•è¿›è¡Œå¤ç°åï¼Œæ±‡æ€»å„æµ‹è¯•æ¡ä»¶ä¸‹çš„æµ‹è¯•ç²¾åº¦ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚

|ä»»åŠ¡|æœ¬é¡¹ç›®ç²¾åº¦|åŸæ–‡çŒ®ç²¾åº¦|
|----|----|----|
|PGD-steps100-restarts20-sourceA|92.555%|89.3%|
|PGD-steps100-restarts20-sourceAâ€˜|97.3955%|95.7%|
|PGD-steps40-restarts1-sourceB|97.22%|96.4%|

è¶…å‚æ•°é…ç½®å¦‚ä¸‹ï¼š

|è¶…å‚æ•°å|è®¾ç½®å€¼|
|----|----|
|lr|0.0003|
|batch_size|128|
|epochs|50|
|alpha|0.01|
|steps|100|
|steps|100/40|
|restarts|20|
|epsilon|0.3|


## ä¸‰ã€æ•°æ®é›†
æœ¬é¡¹ç›®ä½¿ç”¨çš„æ˜¯MNISTæ•°æ®é›†ã€‚

MNISTæ•°æ®é›†æ˜¯æœºå™¨å­¦ä¹ é¢†åŸŸä¸­éå¸¸ç»å…¸çš„ä¸€ä¸ªæ•°æ®é›†ï¼Œç”±60000ä¸ªè®­ç»ƒæ ·æœ¬å’Œ10000ä¸ªæµ‹è¯•æ ·æœ¬ç»„æˆï¼Œæ¯ä¸ªæ ·æœ¬éƒ½æ˜¯ä¸€å¼ 28 * 28åƒç´ çš„ç°åº¦æ‰‹å†™æ•°å­—å›¾ç‰‡ã€‚

è¯¥æ•°æ®é›†ä¸ºç¾å›½å›½å®¶æ ‡å‡†ä¸æŠ€æœ¯ç ”ç©¶æ‰€ï¼ˆNational Institute of Standards and Technology (NIST)ï¼‰å‘èµ·æ•´ç†ï¼Œä¸€å…±ç»Ÿè®¡äº†æ¥è‡ª250ä¸ªä¸åŒçš„äººæ‰‹å†™æ•°å­—å›¾ç‰‡ï¼Œå…¶ä¸­50%æ˜¯é«˜ä¸­ç”Ÿï¼Œ50%æ¥è‡ªäººå£æ™®æŸ¥å±€çš„å·¥ä½œäººå‘˜ã€‚è¯¥æ•°æ®é›†çš„æ”¶é›†ç›®çš„æ˜¯å¸Œæœ›é€šè¿‡ç®—æ³•ï¼Œå®ç°å¯¹æ‰‹å†™æ•°å­—çš„è¯†åˆ«ã€‚

æ•°æ®é›†é“¾æ¥ï¼š[MNIST](http://yann.lecun.com/exdb/mnist/)


## å››ã€ç¯å¢ƒä¾èµ–

- ç¡¬ä»¶ï¼š
    - x86 cpu
    - NVIDIA GPU
- æ¡†æ¶ï¼š
    - PaddlePaddle = 2.1.2

- å…¶ä»–ä¾èµ–é¡¹ï¼š
    - numpy==1.19.3
    - matplotlib==3.3.4


## äº”ã€å¿«é€Ÿå¼€å§‹

### 1ã€æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å¯åŠ¨è®­ç»ƒï¼š
`python train.py --net robust --seed 0`

å»ºç«‹robust networkï¼Œè¿è¡Œå®Œæ¯•åï¼Œæ¨¡å‹å‚æ•°æ–‡ä»¶ä¿å­˜åœ¨./checkpoints/MNIST/ç›®å½•ä¸‹ï¼Œæ‰‹åŠ¨å°†è¯¥æ–‡ä»¶ä¿å­˜è‡³./checkpoints/MNIST_Robust_Modelç›®å½•ä¸‹ã€‚



```python
%cd /home/aistudio/TDLMRAAI_paddle/
!python train.py --net robust --seed 0
```

`python train.py --net robust --seed 10` å»ºç«‹ä¸åŒå‚æ•°çš„networkï¼Œç”¨äºé»‘ç›’æ”»å‡»A

å»ºç«‹ä¸åŒå‚æ•°çš„networkï¼Œè¿è¡Œå®Œæ¯•åï¼Œæ¨¡å‹å‚æ•°æ–‡ä»¶ä¿å­˜åœ¨./checkpoints/MNIST/ç›®å½•ä¸‹ï¼Œæ‰‹åŠ¨å°†è¯¥æ–‡ä»¶ä¿å­˜è‡³./checkpoints/MNIST_BlackboxAç›®å½•ä¸‹ã€‚



```python
%cd /home/aistudio/TDLMRAAI_paddle/
!python train.py --net robust --seed 10
```

    /home/aistudio/TDLMRAAI_paddle
    /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/__init__.py:107: DeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated, and in 3.8 it will stop working
      from collections import MutableMapping
    /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/rcsetup.py:20: DeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated, and in 3.8 it will stop working
      from collections import Iterable, Mapping
    /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/colors.py:53: DeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated, and in 3.8 it will stop working
      from collections import Sized
    /home/aistudio/TDLMRAAI_paddle/helper.py:13: UserWarning:
    This call to matplotlib.use() has no effect because the backend has already
    been chosen; matplotlib.use() must be called *before* pylab, matplotlib.pyplot,
    or matplotlib.backends is imported for the first time.

    The backend was *originally* set to 'module://ipykernel.pylab.backend_inline' by the following code:
      File "train.py", line 9, in <module>
        import helper
      File "/home/aistudio/TDLMRAAI_paddle/helper.py", line 2, in <module>
        import matplotlib.pyplot as plt
      File "/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/pyplot.py", line 71, in <module>
        from matplotlib.backends import pylab_setup
      File "/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/backends/__init__.py", line 16, in <module>
        line for line in traceback.format_stack()


      matplotlib.use('Agg')
    Time passed [minutes]: 0.00.     execution date (d/m/y): 17/08/2021, 15:12:33
    Time passed [minutes]: 0.00.     Dataset name: MNIST
    Time passed [minutes]: 0.00.     checkpoints folder: ./checkpoints/MNIST
    Time passed [minutes]: 0.00.     save checkpoints: True
    Time passed [minutes]: 0.00.     load checkpoints: False
    Time passed [minutes]: 0.00.     results folder: ./results_folder/MNIST
    Time passed [minutes]: 0.00.     show results:  False
    Time passed [minutes]: 0.00.     save results:  False
    Time passed [minutes]: 0.00.     seed: 10
    Time passed [minutes]: 0.00.     execution device: CUDAPlace(0)
    W0817 15:12:37.464154  2714 device_context.cc:404] Please NOTE: device: 0, GPU Compute Capability: 7.0, Driver API Version: 11.0, Runtime API Version: 10.1
    W0817 15:12:37.468314  2714 device_context.cc:422] device: 0, cuDNN Version: 7.6.
    Time passed [minutes]: 0.11.     Train model on MNIST-ORIGIN-NET
    Time passed [minutes]: 0.11.  
    Full Train(training on all training dataset) with selected hp: {'lr': 0.0003, 'batch_size': 128, 'alpha': 0.01, 'steps': 100, 'epsilon': 0.3}
    /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/paddle/fluid/dygraph/varbase_patch_methods.py:382: UserWarning: [93m
    Warning:
    tensor.grad will return the tensor value of the gradient. This is an incompatible upgrade for tensor.grad API.  It's return type changes from numpy.ndarray in version 2.0 to paddle.Tensor in version 2.1.0.  If you want to get the numpy value of the gradient, you can use :code:`x.grad.numpy()` [0m
      warnings.warn(warning_msg)
    /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/paddle/tensor/creation.py:125: DeprecationWarning: `np.object` is a deprecated alias for the builtin `object`. To silence this warning, use `object` by itself. Doing this will not modify any behavior and is safe.
    Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
      if data.dtype == np.object:
    Time passed [minutes]: 2.50.     Epoch 1. Train adversarial accuracy: 0.054538.Train accuracy: 0.21,  Train loss:  2.57

    Time passed [minutes]: 4.85.     Epoch 2. Train adversarial accuracy: 0.130375.Train accuracy: 0.43,  Train loss:  2.29

    Time passed [minutes]: 7.27.     Epoch 3. Train adversarial accuracy: 0.286514.Train accuracy: 0.76,  Train loss:  2.05

    Time passed [minutes]: 9.65.     Epoch 4. Train adversarial accuracy: 0.368876.Train accuracy: 0.87,  Train loss:  1.81

    Time passed [minutes]: 11.98.     Epoch 5. Train adversarial accuracy: 0.429538.Train accuracy: 0.90,  Train loss:  1.60

    Time passed [minutes]: 14.32.     Epoch 6. Train adversarial accuracy: 0.486385.Train accuracy: 0.92,  Train loss:  1.42

    Time passed [minutes]: 16.65.     Epoch 7. Train adversarial accuracy: 0.530661.Train accuracy: 0.93,  Train loss:  1.28

    Time passed [minutes]: 18.98.     Epoch 8. Train adversarial accuracy: 0.568308.Train accuracy: 0.94,  Train loss:  1.16

    Time passed [minutes]: 21.33.     Epoch 9. Train adversarial accuracy: 0.600074.Train accuracy: 0.94,  Train loss:  1.08

    Time passed [minutes]: 23.75.     Epoch 10. Train adversarial accuracy: 0.622018.Train accuracy: 0.94,  Train loss:  1.01

    Time passed [minutes]: 26.16.     Epoch 11. Train adversarial accuracy: 0.643901.Train accuracy: 0.95,  Train loss:  0.96

    Time passed [minutes]: 28.60.     Epoch 12. Train adversarial accuracy: 0.665317.Train accuracy: 0.95,  Train loss:  0.90

    Time passed [minutes]: 30.99.     Epoch 13. Train adversarial accuracy: 0.683136.Train accuracy: 0.95,  Train loss:  0.86

    Time passed [minutes]: 33.43.     Epoch 14. Train adversarial accuracy: 0.696867.Train accuracy: 0.96,  Train loss:  0.82

    Time passed [minutes]: 35.83.     Epoch 15. Train adversarial accuracy: 0.718922.Train accuracy: 0.96,  Train loss:  0.77

    Time passed [minutes]: 38.21.     Epoch 16. Train adversarial accuracy: 0.743626.Train accuracy: 0.96,  Train loss:  0.71

    Time passed [minutes]: 40.60.     Epoch 17. Train adversarial accuracy: 0.764692.Train accuracy: 0.96,  Train loss:  0.66

    Time passed [minutes]: 43.01.     Epoch 18. Train adversarial accuracy: 0.781033.Train accuracy: 0.96,  Train loss:  0.61

    Time passed [minutes]: 45.42.     Epoch 19. Train adversarial accuracy: 0.794921.Train accuracy: 0.96,  Train loss:  0.58

    Time passed [minutes]: 47.80.     Epoch 20. Train adversarial accuracy: 0.808735.Train accuracy: 0.96,  Train loss:  0.54

    Time passed [minutes]: 50.19.     Epoch 21. Train adversarial accuracy: 0.819841.Train accuracy: 0.97,  Train loss:  0.51

    Time passed [minutes]: 52.60.     Epoch 22. Train adversarial accuracy: 0.835027.Train accuracy: 0.97,  Train loss:  0.47

    Time passed [minutes]: 54.99.     Epoch 23. Train adversarial accuracy: 0.850030.Train accuracy: 0.97,  Train loss:  0.43

    Time passed [minutes]: 57.41.     Epoch 24. Train adversarial accuracy: 0.868759.Train accuracy: 0.97,  Train loss:  0.38

    Time passed [minutes]: 59.80.     Epoch 25. Train adversarial accuracy: 0.879603.Train accuracy: 0.97,  Train loss:  0.35

    Time passed [minutes]: 62.17.     Epoch 26. Train adversarial accuracy: 0.885767.Train accuracy: 0.97,  Train loss:  0.33

    Time passed [minutes]: 64.56.     Epoch 27. Train adversarial accuracy: 0.890181.Train accuracy: 0.97,  Train loss:  0.32

    Time passed [minutes]: 66.95.     Epoch 28. Train adversarial accuracy: 0.894540.Train accuracy: 0.97,  Train loss:  0.31

    Time passed [minutes]: 69.33.     Epoch 29. Train adversarial accuracy: 0.899015.Train accuracy: 0.97,  Train loss:  0.30

    Time passed [minutes]: 71.73.     Epoch 30. Train adversarial accuracy: 0.900337.Train accuracy: 0.98,  Train loss:  0.29

    Time passed [minutes]: 74.19.     Epoch 31. Train adversarial accuracy: 0.903568.Train accuracy: 0.98,  Train loss:  0.28

    Time passed [minutes]: 76.72.     Epoch 32. Train adversarial accuracy: 0.905889.Train accuracy: 0.98,  Train loss:  0.27

    Time passed [minutes]: 79.12.     Epoch 33. Train adversarial accuracy: 0.906944.Train accuracy: 0.98,  Train loss:  0.27

    Time passed [minutes]: 81.50.     Epoch 34. Train adversarial accuracy: 0.908571.Train accuracy: 0.98,  Train loss:  0.27

    Time passed [minutes]: 83.87.     Epoch 35. Train adversarial accuracy: 0.908443.Train accuracy: 0.98,  Train loss:  0.26

    Time passed [minutes]: 86.32.     Epoch 36. Train adversarial accuracy: 0.909648.Train accuracy: 0.98,  Train loss:  0.26

    Time passed [minutes]: 88.70.     Epoch 37. Train adversarial accuracy: 0.911075.Train accuracy: 0.98,  Train loss:  0.26

    Time passed [minutes]: 91.14.     Epoch 38. Train adversarial accuracy: 0.912408.Train accuracy: 0.98,  Train loss:  0.26

    Time passed [minutes]: 93.64.     Epoch 39. Train adversarial accuracy: 0.912608.Train accuracy: 0.98,  Train loss:  0.25

    Time passed [minutes]: 96.08.     Epoch 40. Train adversarial accuracy: 0.912519.Train accuracy: 0.98,  Train loss:  0.25

    Time passed [minutes]: 98.48.     Epoch 41. Train adversarial accuracy: 0.914440.Train accuracy: 0.98,  Train loss:  0.25

    Time passed [minutes]: 100.91.     Epoch 42. Train adversarial accuracy: 0.915734.Train accuracy: 0.98,  Train loss:  0.24

    Time passed [minutes]: 103.34.     Epoch 43. Train adversarial accuracy: 0.917128.Train accuracy: 0.98,  Train loss:  0.24

    Time passed [minutes]: 105.77.     Epoch 44. Train adversarial accuracy: 0.917283.Train accuracy: 0.98,  Train loss:  0.24

    Time passed [minutes]: 108.19.     Epoch 45. Train adversarial accuracy: 0.919504.Train accuracy: 0.98,  Train loss:  0.23

    Time passed [minutes]: 113.07.     Epoch 47. Train adversarial accuracy: 0.920781.Train accuracy: 0.98,  Train loss:  0.23

    Time passed [minutes]: 115.47.     Epoch 48. Train adversarial accuracy: 0.922358.Train accuracy: 0.98,  Train loss:  0.22

    Time passed [minutes]: 117.85.     Epoch 49. Train adversarial accuracy: 0.923474.Train accuracy: 0.99,  Train loss:  0.22

    Time passed [minutes]: 120.26.     Epoch 50. Train adversarial accuracy: 0.924007.Train accuracy: 0.99,  Train loss:  0.22

    Time passed [minutes]: 120.26.     training selected hyperparams: {'lr': 0.0003, 'batch_size': 128, 'alpha': 0.01, 'steps': 100, 'epsilon': 0.3}
    Time passed [minutes]: 120.27.     %accuracy on attack: 0.9287109375 with hp: {'epsilon': 0.3}
    Time passed [minutes]: 120.27.     FGSM attack selected hyperparams: {'epsilon': 0.3}
    Time passed [minutes]: 120.38.     %accuracy on attack: 0.8938802083333334 with hp: {'alpha': 0.01, 'steps': 100, 'epsilon': 0.3}
    Time passed [minutes]: 120.38.     PGD attack selected hyperparams: {'alpha': 0.01, 'steps': 100, 'epsilon': 0.3}
    Time passed [minutes]: 120.99.     TEST SCORES of MNIST-ORIGIN-NET with PGD adversarial training:
    Time passed [minutes]: 120.99.     accuracy on test:                         0.9807
    Time passed [minutes]: 120.99.     accuracy on FGSM constructed examples:    0.946
    Time passed [minutes]: 120.99.     accuracy on PGD constructed examples:     0.9163
    Time passed [minutes]: 120.99.     save network to ./checkpoints/MNIST/MNIST-ORIGIN-NET with PGD adversarial training.pdparams


`python train.py --net diff_arch --seed 0` å»ºç«‹ä¸åŒæ¶æ„çš„networkï¼Œç”¨äºé»‘ç›’æ”»å‡»B

å»ºç«‹ä¸åŒæ¶æ„çš„networkï¼Œè¿è¡Œå®Œæ¯•åï¼Œæ¨¡å‹å‚æ•°æ–‡ä»¶ä¿å­˜åœ¨./checkpoints/MNIST/ç›®å½•ä¸‹ï¼Œæ‰‹åŠ¨å°†è¯¥æ–‡ä»¶ä¿å­˜è‡³./checkpoints/MNIST_BlackboxBç›®å½•ä¸‹ã€‚



```python
%cd /home/aistudio/TDLMRAAI_paddle/
!python train.py --net diff_arch --seed 0
```

### 2ã€æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è¿›è¡Œè¯„ä¼°

`python test.py --method white --num_restarts 20`
ç”¨äºç™½ç›’æµ‹è¯•ï¼Œå¯¹åº”PGD-steps100-restarts20-sourceA



```python
%cd /home/aistudio/TDLMRAAI_paddle/
!python test.py --method white --num_restarts 20
```

`python test.py --method blackA --num_restarts 20`
ç”¨äºç½‘ç»œæ¶æ„å·²çŸ¥ï¼Œå‚æ•°æœªçŸ¥çš„é»‘ç›’æµ‹è¯•ï¼Œå¯¹åº”PGD-steps100-restarts20-sourceAâ€™


```python
%cd /home/aistudio/TDLMRAAI_paddle/
!python test.py --method blackA --num_restarts 20
```

`python test.py --method blackB --num_restarts 1`
ç”¨äºç½‘ç»œæ¶æ„æœªçŸ¥é»‘ç›’æµ‹è¯•ï¼Œå¯¹åº”PGD-steps40-restarts1-sourceB



```python
%cd /home/aistudio/TDLMRAAI_paddle/
!python test.py --method blackB --num_restarts 1
```

## å…­ã€å®éªŒæ•°æ®æ¯”è¾ƒåŠå¤ç°å¿ƒå¾—
### 1ã€å®éªŒæ•°æ®æ¯”è¾ƒ

åœ¨ä¸åŒçš„è¶…å‚æ•°é…ç½®ä¸‹ï¼Œæ¨¡å‹çš„æ”¶æ•›æ•ˆæœã€è¾¾åˆ°çš„ç²¾åº¦æŒ‡æ ‡æœ‰è¾ƒå¤§çš„å·®å¼‚ï¼Œä»¥ä¸‹åˆ—ä¸¾ä¸åŒè¶…å‚æ•°é…ç½®ä¸‹ï¼Œå®éªŒç»“æœçš„å·®å¼‚æ€§ï¼Œä¾¿äºæ¯”è¾ƒåˆ†æï¼š

ï¼ˆ1ï¼‰å­¦ä¹ ç‡ï¼š

åŸæ–‡çŒ®é‡‡ç”¨çš„ä¼˜åŒ–å™¨ä¸æœ¬é¡¹ç›®ä¸€è‡´ï¼Œä¸ºAdamä¼˜åŒ–å™¨ï¼ŒåŸæ–‡çŒ®å­¦ä¹ ç‡è®¾ç½®ä¸º0.0001ï¼Œæœ¬é¡¹ç›®ç»è°ƒå‚å‘ç°ï¼Œ
å­¦ä¹ ç‡è®¾ç½®ä¸º0.0003èƒ½å¤Ÿæ›´å¿«ã€æ›´å¥½åœ°æ”¶æ•›ã€‚ä¸åŒå­¦ä¹ ç‡åœ¨è®­ç»ƒæ—¶ï¼Œå¯¹æ”»å‡»æ ·æœ¬çš„ç²¾åº¦å’Œlosså‡½æ•°å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚
![](https://ai-studio-static-online.cdn.bcebos.com/e500e6a5336d41bfb3d8addc5d2062a9db91187ec9564aec8422494600389cd0)

ï¼ˆ2ï¼‰è®­ç»ƒæ—¶ï¼Œæ˜¯å¦åŠ å…¥åŸå§‹æ ·æœ¬ï¼š

æ ¹æ®æœ¬é¡¹ç›®æ‰€å‚è€ƒçš„
[repo](https://github.com/eldadp100/Towards-Deep-Learning-Models-Resistant-to-Adversarial-Attacks-Implementation)
æè¿°ï¼Œè®­ç»ƒæ—¶åŠ å…¥åŸå§‹æ ·æœ¬ï¼Œæœ‰åˆ©äºæ¨¡å‹ç²¾åº¦çš„æé«˜ã€‚æœ¬é¡¹ç›®åˆ†åˆ«åœ¨ç›¸åŒè¶…å‚æ•°é…ç½®ä¸‹ï¼Œæ¯”è¾ƒäº†æ˜¯å¦åŠ å…¥åŸå§‹æ ·æœ¬è¿›è¡Œè®­ç»ƒçš„å®éªŒç»“æœï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚

|æµ‹è¯•é¡¹| add origin samples | no original samples |
|---| --- | --- |
| æµ‹è¯•é›†ACC | 98.86% | 98.56% |
| FGSMæ”»å‡»ACC | 96.17% | 96.31% |
| PGDæ”»å‡»ACC | 92.45% | 93.44% |

åŸæ–‡çŒ®ä½œè€…ç®—æ³•ï¼Œè®­ç»ƒæ—¶åªé’ˆå¯¹ç”Ÿæˆçš„å¯¹æŠ—æ ·æœ¬ï¼Œè®­ç»ƒæ—¶ä¸åŠ å…¥åŸå§‹æ ·æœ¬ã€‚é€šè¿‡ä¸Šè¡¨å¯¹æ¯”æ•°æ®å¯çŸ¥ï¼Œ
å¢åŠ åŸå§‹æ ·æœ¬ï¼Œæœ‰åˆ©äºå¾®å°æå‡çœŸå®æ ·æœ¬çš„å‡†ç¡®ç‡ï¼ˆ0.3%ï¼‰ï¼Œä½†ä¼šå¯¼è‡´æ”»å‡»æ ·æœ¬å‡†ç¡®ç‡ç•¥æœ‰ä¸‹é™ã€‚

ä½†æ€»ä½“ä¸Šï¼Œå¯¹æŒ‡æ ‡å½±å“å¾ˆå°ã€‚

ï¼ˆ3ï¼‰initialer

ï¼ˆ4ï¼‰batch_size

ï¼ˆ5ï¼‰epochè½®æ¬¡

æœ¬é¡¹ç›®è®­ç»ƒæ—¶ï¼Œé‡‡ç”¨çš„epochè½®æ¬¡ä¸º50ã€‚LOSSå’Œå¯¹æŠ—å‡†ç¡®ç‡åŸºæœ¬ç¨³å®šï¼Œæ¨¡å‹å¤„äºæ”¶æ•›çŠ¶æ€ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚
![](https://ai-studio-static-online.cdn.bcebos.com/105d01764fb74fd8a6a93de97b0a0755d4f9e6734a454ff0b02b5a553ea4303a)



### 2ã€å¤ç°å¿ƒå¾—
æœ¬æ¬¡è®ºæ–‡å¤ç°ï¼Œç”±äºè®ºæ–‡ä½œè€…å¹¶æœªç»™å‡ºåŸå§‹çš„æ¨¡å‹å‚è€ƒå®ç°ï¼Œä»…æä¾›äº†éƒ¨åˆ†åŸºäºTensorFlowçš„éƒ¨åˆ†ä»£ç ï¼Œå¤ç°éš¾åº¦æ¯”è¾ƒå¤§ã€‚
å‰æœŸé™¤äº†å¯¹æ–‡çŒ®æœ¬èº«ç ”è¯»ä»¥å¤–ï¼ŒåŒæ—¶åœ¨ç½‘ä¸ŠæŸ¥é˜…äº†å¾ˆå¤šèµ„æ–™ï¼Œä»¥åŠåŒé¢†åŸŸçš„ç›¸ä¼¼å®ç°ä»£ç ã€‚è®ºæ–‡å¤ç°è¿‡ç¨‹ä¸­ï¼Œ
æ‰€å­¦åˆ°çš„é¢†åŸŸçŸ¥è¯†ï¼Œä»¤æˆ‘è·ç›ŠåŒªæµ…ï¼Œå¯¹å¯¹æŠ—æ”»å‡»æ–¹å‘çš„ç ”ç©¶ä¹Ÿæœ‰äº†æ›´æ·±å…¥çš„ç†è§£ã€‚

çº¸ä¸Šå¾—æ¥ç»ˆè§‰æµ…ï¼Œç»çŸ¥æ­¤äº‹è¦èº¬è¡Œã€‚å¤äººè¯šä¸æ¬ºæˆ‘ï¼

é™¤äº†æ–‡çŒ®æœ¬èº«çš„ç†è®ºå­¦ä¹ ï¼Œåœ¨é¡¹ç›®å®ç°è¿‡ç¨‹ä¸­ï¼Œç»†è‡´æ¯”è¾ƒäº†pytorchå’Œpaddleæ¡†æ¶çš„å®ç°å¼‚åŒã€‚
è­¬å¦‚ï¼Œæ¨¡å‹çš„åˆå§‹åŒ–æ–¹å¼ï¼Œpytorché»˜è®¤é‡‡ç”¨kaiming_normalè¿›è¡Œåˆå§‹åŒ–ï¼›è€Œpaddleé»˜è®¤é‡‡ç”¨Xavier_normalã€‚
å¯¹äºä¸€èˆ¬çš„ç½‘ç»œè®­ç»ƒï¼Œä»…ä»…åˆå§‹åŒ–éƒ¨åˆ†çš„å¾®å°å·®å¼‚é€šå¸¸ä¸ä¼šå¼•èµ·å¤§é—®é¢˜ï¼Œä½†é¡¹ç›®ä¼¼æœ‰ä¸åŒã€‚

æœ¬é¡¹ç›®å¼€å§‹ä½¿ç”¨paddleçš„é»˜è®¤åˆå§‹åŒ–ï¼Œå³Xavier_normalï¼Œé€šå¸¸è¿™ç§æ–¹å¼åœ¨å¤§å¤šæ•°ç½‘ç»œä¸‹éƒ½æ˜¯æœ€ä½³çš„åˆå§‹åŒ–é…ç½®æ–¹å¼ã€‚ä½†æœ¬é¡¹ç›®åœ¨Xavier_normalåˆå§‹åŒ–åï¼Œ
ç½‘ç»œæ”¶æ•›é€Ÿåº¦ææ…¢ï¼Œç²¾åº¦ä¹Ÿæ¯”è¾ƒå·®ï¼Œè¿Ÿè¿Ÿä¸èƒ½è¾¾åˆ°è®ºæ–‡æŒ‡æ ‡ã€‚ç»åå¤ç ”ç©¶æ¯”è¾ƒï¼Œæ”¹ç”¨kaiming_normalåï¼Œæ‰çœŸæ­£ä¸pytorchå¯¹é½ï¼Œç²¾åº¦ä¹Ÿè¾¾åˆ°äº†ç†æƒ³çŠ¶æ€ã€‚


## ä¸ƒã€æ¨¡å‹ä¿¡æ¯

è®­ç»ƒå®Œæˆåï¼Œæ¨¡å‹ä¿å­˜åœ¨checkpointsç›®å½•ä¸‹ã€‚

è®­ç»ƒæ—¥å¿—ä¿å­˜åœ¨results_folderç›®å½•ä¸‹ï¼Œæµ‹è¯•æ—¥å¿—ä¿å­˜åœ¨test_results_folderç›®å½•ä¸‹ã€‚

| ä¿¡æ¯ | è¯´æ˜ |
| --- | --- |
| å‘å¸ƒè€… | hrdwsong |
| æ—¶é—´ | 2021.08 |
| æ¡†æ¶ç‰ˆæœ¬ | Paddle 2.1.2 |
| åº”ç”¨åœºæ™¯ | å¯¹æŠ—è®­ç»ƒ |
| æ”¯æŒç¡¬ä»¶ | GPUã€CPU |
| githubåœ°å€ | https://github.com/hrdwsong/TDLMR2AA-Paddle |


è¯·ç‚¹å‡»[æ­¤å¤„](https://ai.baidu.com/docs#/AIStudio_Project_Notebook/a38e5576)æŸ¥çœ‹æœ¬ç¯å¢ƒåŸºæœ¬ç”¨æ³•.  <br>
Please click [here ](https://ai.baidu.com/docs#/AIStudio_Project_Notebook/a38e5576) for more detailed instructions.
