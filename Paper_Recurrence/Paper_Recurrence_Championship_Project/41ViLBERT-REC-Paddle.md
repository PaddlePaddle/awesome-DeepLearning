# åŸºäºpaddleå®ç°çš„ViLBERTæ¨¡å‹

åŸºäº[paddle](https://github.com/PaddlePaddle/Paddle)æ¡†æ¶çš„[ViLBERT: Pretraining Task-Agnostic Visiolinguistic Representations for Vision-and-Language Tasks](https://arxiv.org/abs/1908.02265)å®ç°

**æ³¨:æœ¬é¡¹ç›®æ ¹ç›®å½•åœ¨/home/aistudio/work/ViLBERT-REC-Paddleä¸‹**

## ä¸€ã€ç®€ä»‹

æœ¬é¡¹ç›®ä½¿ç”¨[paddle](https://github.com/PaddlePaddle/Paddle)æ¡†æ¶å¤ç°[ViLBERT](https://arxiv.org/abs/1908.02265)æ¨¡å‹ã€‚è¯¥æ¨¡å‹åŒ…å«ä¸¤ä¸ªå¹¶è¡Œçš„æµï¼Œåˆ†åˆ«ç”¨äºç¼–ç visualå’Œlanguageï¼Œå¹¶ä¸”åŠ å…¥äº† co-attention transformer layer æ¥å¢å¼ºä¸¤è€…ä¹‹é—´çš„äº¤äº’ï¼Œå¾—åˆ° pretrained modelã€‚ä½œè€…åœ¨å¤šä¸ª vision-language ä»»åŠ¡ä¸Šå¾—åˆ°äº†å¤šä¸ªç‚¹çš„æå‡ã€‚

**è®ºæ–‡:**

* [1] J. Lu, D. Batra, D. Parikh, S. Lee, "ViLBERT: Pretraining Task-Agnostic Visiolinguistic Representations for Vision-and-Language Tasks", NIPS, 2019.

**å‚è€ƒé¡¹ç›®:**

* [vilbert-multi-task](https://github.com/facebookresearch/vilbert-multi-task) [å®˜æ–¹å®ç°]

## äºŒã€å¤ç°ç²¾åº¦

> æ‰€æœ‰æŒ‡æ ‡å‡ä¸ºæ¨¡å‹åœ¨[RefCOCO+](https://arxiv.org/abs/1608.00272)çš„éªŒè¯é›†è¯„ä¼°è€Œå¾—

| æŒ‡æ ‡ | åŸè®ºæ–‡ | å¤ç°ç²¾åº¦ |
| :---: | :---: | :---: |
| Acc | 72.34 | 72.71 |

## ä¸‰ã€æ•°æ®é›†

æœ¬é¡¹ç›®æ‰€ä½¿ç”¨çš„æ•°æ®é›†ä¸º[RefCOCO+](https://arxiv.org/abs/1608.00272)ã€‚è¯¥æ•°æ®é›†å…±åŒ…å«æ¥è‡ª19,992å¼ å›¾åƒçš„49,856ä¸ªç›®æ ‡å¯¹è±¡ï¼Œå…±è®¡141,565æ¡æŒ‡ä»£è¡¨è¾¾ã€‚æœ¬é¡¹ç›®ä½¿ç”¨ä½œè€…æä¾›çš„é¢„æå–çš„`bottom-up`ç‰¹å¾ï¼Œå¯ä»¥ä»[è¿™é‡Œ](https://www.dropbox.com/sh/4jqadcfkai68yoe/AADHI6dKviFcraeCMdjiaDENa?dl=0)ä¸‹è½½å¾—åˆ°ï¼ˆæˆ‘ä»¬æä¾›äº†è„šæœ¬ä¸‹è½½è¯¥æ•°æ®é›†ä»¥åŠå›¾åƒç‰¹å¾ï¼Œè§[download_dataset.sh](https://github.com/fuqianya/ViLBERT-Paddle/blob/main/download_dataset.sh)ï¼‰ã€‚

## å››ã€ç¯å¢ƒä¾èµ–

* ç¡¬ä»¶ï¼šCPUã€GPU

* è½¯ä»¶ï¼š
    * Python 3.8
    * PaddlePaddle == 2.1.0

## äº”ã€å¿«é€Ÿå¼€å§‹

### Step1: å®‰è£…ç¯å¢ƒä¾èµ–


```python
!pip install boto3 lmdb
```

### Step2: ä¸‹è½½æ•°æ®

```bash
# ä¸‹è½½æ•°æ®é›†
bash ./download_dataset.sh

# ä¸‹è½½paddleæ ¼å¼çš„é¢„è®­ç»ƒæ¨¡å‹
# æ”¾äºcheckpoints/bert_base_6_layer_6_connect_freeze_0ä¸‹
# ä¸‹è½½é“¾æ¥: https://drive.google.com/file/d/1QMJz5anz_git8NFThUgacOBgYti_of4g/view?usp=sharing

# ç¼–è¯‘REFER
cd pyutils/refer && make
cd ..
```

### Step3: è®­ç»ƒ


```python
!cd /home/aistudio/work/ViLBERT-REC-Paddle && python train.py
```

    09/06/2021 14:23:14 - INFO - __main__ -   Loading refcoco+ Dataset with batch size 256
    [32m[2021-09-06 14:23:14,931] [    INFO][0m - Downloading bert-base-uncased-vocab.txt from https://paddle-hapi.bj.bcebos.com/models/bert/bert-base-uncased-vocab.txt[0m
    100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 227/227 [00:00<00:00, 4258.58it/s]
    loading dataset refcoco+ into memory...
    creating index...
    index created.
    DONE (t=12.26s)
    42278 refs are in split [train].
    loading entries from data/referExpression/cache/refcoco+_train_20_100.pkl
    loading dataset refcoco+ into memory...
    creating index...
    index created.
    DONE (t=15.59s)
    3805 refs are in split [val].
    loading entries from data/referExpression/cache/refcoco+_val_20_100.pkl
    W0906 14:23:45.809420   289 device_context.cc:404] Please NOTE: device: 0, GPU Compute Capability: 7.0, Driver API Version: 10.1, Runtime API Version: 10.1
    W0906 14:23:45.813421   289 device_context.cc:422] device: 0, cuDNN Version: 7.6.
    ***** Running training *****
      Num Iters:  470
      Batch size:  256
      Num steps: 9400
    ====>start epoch 0:
    Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 470/470 [24:08<00:00,  3.08s/it]
    Eval: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 43/43 [00:43<00:00,  1.01s/it]
    09/06/2021 14:48:47 - INFO - __main__ -   ** ** Epoch {0} done! Traing loss: 3.83981, Val accuracy: 0.6459
    ====>start epoch 1:
    Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 470/470 [23:51<00:00,  3.05s/it]
    Eval: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 43/43 [00:42<00:00,  1.00it/s]
    09/06/2021 15:13:23 - INFO - __main__ -   ** ** Epoch {1} done! Traing loss: 2.31176, Val accuracy: 0.6949
    09/06/2021 15:13:23 - INFO - __main__ -   ** ** * Saving fine - tuned model on bert_base_6layer_6conect-refcoco+** ** *
    ====>start epoch 2:
    Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 470/470 [23:54<00:00,  3.05s/it]
    Eval: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 43/43 [00:41<00:00,  1.03it/s]
    09/06/2021 15:38:03 - INFO - __main__ -   ** ** Epoch {2} done! Traing loss: 1.80026, Val accuracy: 0.7080
    ====>start epoch 3:
    Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 470/470 [23:56<00:00,  3.06s/it]
    Eval: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 43/43 [00:41<00:00,  1.04it/s]
    09/06/2021 16:02:41 - INFO - __main__ -   ** ** Epoch {3} done! Traing loss: 1.40603, Val accuracy: 0.7086
    09/06/2021 16:02:41 - INFO - __main__ -   ** ** * Saving fine - tuned model on bert_base_6layer_6conect-refcoco+** ** *
    ====>start epoch 4:
    Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 470/470 [23:55<00:00,  3.05s/it]
    Eval: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 43/43 [00:41<00:00,  1.02it/s]
    09/06/2021 16:27:22 - INFO - __main__ -   ** ** Epoch {4} done! Traing loss: 1.13971, Val accuracy: 0.7107
    ====>start epoch 5:
    Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 470/470 [23:55<00:00,  3.05s/it]
    Eval: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 43/43 [00:40<00:00,  1.05it/s]
    09/06/2021 16:51:59 - INFO - __main__ -   ** ** Epoch {5} done! Traing loss: 0.96396, Val accuracy: 0.7120
    09/06/2021 16:51:59 - INFO - __main__ -   ** ** * Saving fine - tuned model on bert_base_6layer_6conect-refcoco+** ** *
    ====>start epoch 6:
    Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 470/470 [23:51<00:00,  3.05s/it]
    Eval: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 43/43 [00:41<00:00,  1.04it/s]
    09/06/2021 17:16:35 - INFO - __main__ -   ** ** Epoch {6} done! Traing loss: 0.86292, Val accuracy: 0.7156
    ====>start epoch 7:
    Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 470/470 [23:57<00:00,  3.06s/it]
    Eval: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 43/43 [00:40<00:00,  1.07it/s]
    09/06/2021 17:41:13 - INFO - __main__ -   ** ** Epoch {7} done! Traing loss: 0.78510, Val accuracy: 0.7173
    09/06/2021 17:41:13 - INFO - __main__ -   ** ** * Saving fine - tuned model on bert_base_6layer_6conect-refcoco+** ** *
    ====>start epoch 8:
    Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 470/470 [23:52<00:00,  3.05s/it]
    Eval: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 43/43 [00:40<00:00,  1.06it/s]
    09/06/2021 18:05:49 - INFO - __main__ -   ** ** Epoch {8} done! Traing loss: 0.72758, Val accuracy: 0.7139
    ====>start epoch 9:
    Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 470/470 [23:57<00:00,  3.06s/it]
    Eval: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 43/43 [00:41<00:00,  1.03it/s]
    09/06/2021 18:30:29 - INFO - __main__ -   ** ** Epoch {9} done! Traing loss: 0.69806, Val accuracy: 0.7183
    09/06/2021 18:30:29 - INFO - __main__ -   ** ** * Saving fine - tuned model on bert_base_6layer_6conect-refcoco+** ** *
    ====>start epoch 10:
    Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 470/470 [23:40<00:00,  3.02s/it]
    Eval: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 43/43 [00:42<00:00,  1.02it/s]
    09/06/2021 18:54:56 - INFO - __main__ -   ** ** Epoch {10} done! Traing loss: 0.66901, Val accuracy: 0.7122
    ====>start epoch 11:
    Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 470/470 [23:47<00:00,  3.04s/it]
    Eval: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 43/43 [00:41<00:00,  1.03it/s]
    09/06/2021 19:19:26 - INFO - __main__ -   ** ** Epoch {11} done! Traing loss: 0.64070, Val accuracy: 0.7201
    09/06/2021 19:19:26 - INFO - __main__ -   ** ** * Saving fine - tuned model on bert_base_6layer_6conect-refcoco+** ** *
    ====>start epoch 12:
    Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 470/470 [23:44<00:00,  3.03s/it]
    Eval: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 43/43 [00:42<00:00,  1.02it/s]
    09/06/2021 19:43:56 - INFO - __main__ -   ** ** Epoch {12} done! Traing loss: 0.57114, Val accuracy: 0.7263
    ====>start epoch 13:
    Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 470/470 [23:42<00:00,  3.03s/it]
    Eval: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 43/43 [00:42<00:00,  1.02it/s]
    09/06/2021 20:08:22 - INFO - __main__ -   ** ** Epoch {13} done! Traing loss: 0.54065, Val accuracy: 0.7264
    09/06/2021 20:08:22 - INFO - __main__ -   ** ** * Saving fine - tuned model on bert_base_6layer_6conect-refcoco+** ** *
    ====>start epoch 14:
    Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 470/470 [23:42<00:00,  3.03s/it]
    Eval: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 43/43 [00:41<00:00,  1.03it/s]
    09/06/2021 20:32:49 - INFO - __main__ -   ** ** Epoch {14} done! Traing loss: 0.52415, Val accuracy: 0.7254
    ====>start epoch 15:
    Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 470/470 [23:44<00:00,  3.03s/it]
    Eval: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 43/43 [00:42<00:00,  1.01it/s]
    09/06/2021 20:57:16 - INFO - __main__ -   ** ** Epoch {15} done! Traing loss: 0.51826, Val accuracy: 0.7271
    09/06/2021 20:57:16 - INFO - __main__ -   ** ** * Saving fine - tuned model on bert_base_6layer_6conect-refcoco+** ** *
    ====>start epoch 16:
    Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 470/470 [23:46<00:00,  3.03s/it]
    Eval: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 43/43 [00:42<00:00,  1.01it/s]
    09/06/2021 21:21:48 - INFO - __main__ -   ** ** Epoch {16} done! Traing loss: 0.51339, Val accuracy: 0.7273
    ====>start epoch 17:
    Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 470/470 [23:46<00:00,  3.04s/it]
    Eval: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 43/43 [00:42<00:00,  1.02it/s]
    09/06/2021 21:46:18 - INFO - __main__ -   ** ** Epoch {17} done! Traing loss: 0.51202, Val accuracy: 0.7272
    09/06/2021 21:46:18 - INFO - __main__ -   ** ** * Saving fine - tuned model on bert_base_6layer_6conect-refcoco+** ** *
    ====>start epoch 18:
    Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 470/470 [23:48<00:00,  3.04s/it]
    Eval: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 43/43 [00:41<00:00,  1.04it/s]
    09/06/2021 22:10:51 - INFO - __main__ -   ** ** Epoch {18} done! Traing loss: 0.50981, Val accuracy: 0.7274
    ====>start epoch 19:
    Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 470/470 [23:49<00:00,  3.04s/it]
    Eval: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 43/43 [00:41<00:00,  1.03it/s]
    09/06/2021 22:35:23 - INFO - __main__ -   ** ** Epoch {19} done! Traing loss: 0.50994, Val accuracy: 0.7271
    09/06/2021 22:35:23 - INFO - __main__ -   ** ** * Saving fine - tuned model on bert_base_6layer_6conect-refcoco+** ** *
    [0m

### Step4: æµ‹è¯•


```python
!python eval.py --from_pretrained ./checkpoints/refcoco+_bert_base_6layer_6conect-pretrained/paddle_model_19.pdparams
```

### ä½¿ç”¨é¢„è®­ç»ƒæ¨¡å‹è¿›è¡Œé¢„æµ‹

æ¨¡å‹ä¸‹è½½: [è°·æ­Œäº‘ç›˜](https://drive.google.com/file/d/19gbGuVm9hgVPm_XzAUrTpeDmObr5ZAv3/view?usp=sharing)

å°†ä¸‹è½½çš„æ¨¡å‹æƒé‡ä»¥åŠè®­ç»ƒä¿¡æ¯æ”¾åˆ°`checkpoints/refcoco+_bert_base_6layer_6conect-pretrained`ç›®å½•ä¸‹, è¿è¡Œ`step5`çš„æŒ‡ä»¤è¿›è¡Œæµ‹è¯•ã€‚

è¯·ç‚¹å‡»[æ­¤å¤„](https://ai.baidu.com/docs#/AIStudio_Project_Notebook/a38e5576)æŸ¥çœ‹æœ¬ç¯å¢ƒåŸºæœ¬ç”¨æ³•.  <br>
Please click [here ](https://ai.baidu.com/docs#/AIStudio_Project_Notebook/a38e5576) for more detailed instructions.
