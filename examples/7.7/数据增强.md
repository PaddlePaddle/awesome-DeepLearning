## 数据增强

数据增强可以说是深度学习性能提升的基石，特别是在训练样本不够的情况下。一句话，数据增强可以让强者更强，弱者变强。
图像数据增强广泛用在图像分类、目标检测和图像分割等视觉任务中。

### 1. 有监督的数据增强

有监督数据增强，即采用预设的数据变换规则，在已有数据的基础上进行数据的扩增，包含单样本数据增强和多样本数据增强，其中单样本又包括几何操作类，颜色变换类。

#### 1.1 单样本数据增强

所谓单样本数据增强，即增强一个样本的时候，全部围绕着该样本本身进行操作，包括几何变换类，颜色变换类等。

* 几何变换类
   
   几何变换类即对图像进行几何变换，包括翻转，旋转，裁剪，变形，缩放等各类操作。
* 颜色变换类
   
   上面的几何变换类操作，没有改变图像本身的内容，它可能是选择了图像的一部分或者对像素进行了重分布。如果要改变图像本身的内容，就属于颜色变换类的数据增强了，常见的包括噪声、模糊、颜色变换、擦除、填充等等。
   
#### 1.2 多样本数据增强

不同于单样本数据增强，多样本数据增强方法利用多个样本来产生新的样本，下面介绍几种方法。

1. SMOTE
   
   SMOTE即Synthetic Minority Over-sampling Technique方法，它是通过人工合成新样本来处理样本不平衡问题，从而提升分类器性能。SMOTE方法是基于插值的方法，它可以为小样本类合成新的样本
2. SamplePairing
   
   SamplePairing方法的原理非常简单，从训练集中随机抽取两张图片分别经过基础数据增强操作(如随机翻转等)处理后经像素以取平均值的形式叠加合成一个新的样本，标签为原样本标签中的一种。这两张图片甚至不限制为同一类别，这种方法对于医学图像比较有效。
3.  mixup
   
    mixup是Facebook人工智能研究院和MIT在“Beyond Empirical Risk Minimization”中提出的基于邻域风险最小化原则的数据增强方法，它使用线性插值得到新样本数据。

### 2. 无监督的数据增强

无监督的数据增强方法包括两类：
- 通过模型学习数据的分布，随机生成与训练数据集分布一致的图片，代表方法GAN。
- 通过模型，学习出适合当前任务的数据增强方法，代表方法AutoAugment。
  
#### 2.1 GAN

GAN（generative adversarial networks）包含两个网络，一个是生成网络，一个是对抗网络，基本原理如下：
- G是一个生成图片的网络，它接收随机的噪声z，通过噪声生成图片，记做G(z) 。
- D是一个判别网络，判别一张图片是不是“真实的”，即是真实的图片，还是由G生成的图片。

#### 2.2 Autoaugmentation

AutoAugment是Google提出的自动选择最优数据增强方案的研究，这是无监督数据增强的重要研究方向。它的基本思路是使用增强学习从数据本身寻找最佳图像变换策略，对于不同的任务学习不同的增强方法，流程如下：

- 准备16个常用的数据增强操作。

- 从16个中选择5个操作，随机产生使用该操作的概率和相应的幅度，将其称为一个sub-policy，一共产生5个sub-polices。

- 对训练过程中每一个batch的图片，随机采用5个sub-polices操作中的一种。

- 通过模型在验证集上的泛化能力来反馈，使用的优化方法是增强学习方法。

- 经过80~100个epoch后网络开始学习到有效的sub-policies。

- 之后串接这5个sub-policies，然后再进行最后的训练。