[toc]
##损失函数

&emsp;&emsp;在深度学习中，损失函数扮演着至关重要的角色。通过对最小化损失函数，使模型达到收敛状态，减少模型预测值的误差。因此，不同的损失函数，对模型的影响是重大的。在工作中经常用到的损失函数：
- 图像分类：交叉熵损失
- 目标检测：Focal loss，L1/L2损失函数，IOU Loss，GIOU，DIOU，CIOU
- 图像识别：Triplet Loss，Center Loss，Sphereface，Cosface，Arcface

---
##python代码实现
&emsp;&emsp;在这里只实现交叉熵损失函数和MSE损失函数。

###交叉熵损失函数

$$CrossEntropy = -\sum_{i=1}^np(x_i)\ln{(q(x_i))}$$

```python
import numpy as np


class CrossEntropy(object):
    def __init__(self):
        self.eps = np.finfo(float).eps

    def __str__(self):
        return 'CrossEntropy'

    def __call__(self, y, y_pred):
        return self.loss(y, y_pred)

    def loss(self, y, y_pred):
        loss = -np.sum(y * np.log(y_pred + self.eps), axis=-1)
        return loss

    def grad(self, y, y_pred):
        grad = y_pred - y
        return grad
```

###MSE损失函数

$$MSE=\frac{1}{n}\sum_{i=1}^{m}\omega_i(y_i-\widehat{y_i})^2$$

```python
import numpy as np


class MSE(object):
    def __str__(self):
        return 'MSE'

    def __call__(self, y, y_pred):
        return self.loss(y, y_pred)

    def loss(self, y, y_pred):
        return 0.5 * np.sum((y_pred - y) ** 2, axis=-1)

    def grad(self, y, y_pred):
        return y_pred - y
```
