# 深度学习基础

### 基于层次softmax训练词向量

#### 哈夫曼树
哈夫曼树是一颗二叉树，该树的带权路径长度最小，是最优二叉树。哈夫曼树的构建比较简单，如下：

输入：权值为 $(w_1,w_2,...w_n)$ 的 n 个节点
输出：对应的霍夫曼树
* 将 $(w_1,w_2,...w_n)$看做 n 棵单结点树；
* 在森林中选择**根节点**权值最小的两棵树合并成新树，这两颗树分别作为新树的左右子树。新树的根节点权重为左右子树的根节点权重之和。
* 将之前的根节点权值最小的两棵树从森林删除，并把新树加入森林。
* 重复步骤2）和3）直到森林里只有一棵树为止。
<br></br>
<center><img src="https://ai-studio-static-online.cdn.bcebos.com/5559cd1b8ed04aff835202e6543057172fe196a9a1a449cebb5f9ce14684920b" width = "800"></center>
<br></br>

* 如果将二叉树的左路径标为 0， 右路径标为 1，那么一个元素的从根节点开始，寻找该元素的路径就可以用0,1 表示，就构成了哈夫曼编码，如图：
<br></br>
<center><img src="https://ai-studio-static-online.cdn.bcebos.com/4b156c19f0094dd8a5de7a33e4dfd37f182fe2ba19524f788cabe8442dd5d5b4" width = "300"></center>
<br></br>

#### 简化方法
在语料库中，词量非常庞大，倘若有 10000 维，那么最终输出层要计算 10000 维的Softmax。为了简化计算，常用的方法有层次 Softmax。

层次 Softmax 应用了哈夫曼树的思想，元素对应词，元素的权值对应词出现的频率，那么出现越频繁的词越接近哈夫曼树的根节点，其搜索的频率也越频繁。所以根据词频构建哈夫曼树。

利用 Sigmoid 函数得到哈夫曼树中的0，1路径。

$\sigma(x;θ)=\frac{1}{1+e^{-z}}， z=x^Tθ+b$

Sigmoid 函数的取值范围为 (0, 1)，刚好可以用来进行 0,1 输出，哈夫曼树是二叉树，那么每次进行路径选择可视为一个二分类，那么就变成了多次二分类，称为层次 Softmax.

对于当前词的上下文词，经过计算到投影层后，进入层次 Softmax。将上下文词向量的结果求和取平均，将结果推给 Sigmoid 函数。

在最终输出层，便用到了词在哈夫曼树根节点走向目标叶子结点的搜索路径。对于每一次决策左右，都是由 Sigmoid 计算得到的，而 Sigmoid 计算的结果都可以视为概率，那么我们可以将路径的概率相乘，计算最大似然，得到损失函数：

$L(x_i;θ) = \prod_{j=2}^{l_i} [\sigma(x_i;θ)] ^{1-y_j}[1-\sigma(x_i;θ)]^{y_j}$

其中$l_i$为该词的搜索路径。

之后就可以像求解 Logistic 回归一样进行反向传播了。




### LSTM实现任务
* **词性标注，命名实体识别类任务**

识别文本中具有特定意义的实体（人名、地名、机构名、专有名词），从知识图谱的角度来说就是从非结构化文本中获取图谱中的实体及实体属性。

<br></br>
<center><img src="https://ai-studio-static-online.cdn.bcebos.com/7647a4769c7548729fce2c368a79d6cc350a65f5a435487fb046d623f84d0af7" width = "600"></center>
<center><br>图3：LSTM-CRF模型</br></center>
<br></br>

* 生成文本，比如语音识别、机器翻译类任务
<br></br>
<center><img src="https://ai-studio-static-online.cdn.bcebos.com/b38de1b23d82489ca190274f72d784feeaf042fef1d944f7ad9377cd4202662e" width = "600"></center>
<center><br>图3：语音识别、机器翻译</br></center>
<br></br>

* 循环神经网络也可以用于问答系统，机器翻译类任务

<br></br>
<center><img src="https://ai-studio-static-online.cdn.bcebos.com/98aa58ae0ff74272818e6237c5305e25cae780d716b24db286e392fbde8f34cd" width = "600"></center>
<center><br>图3：问答系统，机器翻译类任务</br></center>
<br></br>
![](https://ai-studio-static-online.cdn.bcebos.com/91145faf8117416eb63c7c1d55edb8dc1e033253b8344fcbb4c2bc1a7f38c5b0)





```python

```
